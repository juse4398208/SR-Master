#!/bin/sh

# 獲取將要推送的遠端分支名稱
remote_branch=$(git rev-parse --abbrev-ref HEAD)

# 僅當推送到 main 分支時執行版本號遞增
if [ "$remote_branch" == "main" ]; then
    echo "Pushing to main branch, updating version number..."

    # 讀取並遞增 version.txt 中的版本號
    version_file="version.txt"
    current_version=$(cat $version_file)
    new_version=$((current_version + 1))
    echo $new_version > $version_file

    # 添加 version.txt 到最後一次提交
    git add $version_file
    git commit --amend --no-edit

    echo "Version updated to $new_version"
else
    echo "Pushing to $remote_branch branch, no version increment."
fi
